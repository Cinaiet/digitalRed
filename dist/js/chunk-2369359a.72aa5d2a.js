(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2369359a"],{"07bb":function(t,e,i){"use strict";i("7cfe")},"1f0d":function(t,e,i){t.exports=i.p+"img/bg_new.ec222abf.png"},3999:function(t,e,i){t.exports=i.p+"img/home-text.06651562.png"},4507:function(t,e,i){t.exports=i.p+"img/amt.522b6dbb.png"},"52bc":function(t,e,i){t.exports=i.p+"img/red-package.730688f6.png"},"7abe":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-box display-flex box-column"},[e("img",{staticClass:"home-img",attrs:{src:t.bgImg,alt:""}}),e("img",{staticClass:"home-logo",attrs:{src:t.logo,alt:""}}),e("img",{staticClass:"home-text",attrs:{src:t.homeText,alt:""}}),e("img",{staticClass:"home-pack",attrs:{src:t.redPackImg,alt:""}}),e("img",{staticClass:"home-amt",attrs:{src:t.amtImg,alt:""}}),t.loading?e("div",{staticClass:"loading"},[e("van-loading",{attrs:{type:"spinner",color:"#ccc"}})],1):e("div",{staticClass:"box-flex1 content"},[e("div",{staticClass:"vouchers"},[e("div",{staticClass:"vouchers-left"},[e("div",[t._v("待领取")]),e("div",{staticClass:"sale"},[e("span",[t._v("￥")]),t._v(t._s((t.activityInfo.amt/100).toFixed(2))+"\n        ")])]),e("div",{staticClass:"vouchers-right"},[e("div",[t._v(t._s(t.activityInfo.activity))]),e("div",[t._v("*领取无需中行银行卡")])])]),t.supportFlag?t._e():e("div",{staticClass:"explain location permission"},[e("div",[t._v("很抱歉，您所在的地区暂未开启数字⼈⺠币试点⼯作，⽆法领取红包")]),e("div",{staticClass:"btn"},[t._v("请联系赠奖商户")])]),t.supportFlag?t._e():e("div",{staticClass:"outer"},[e("div",{staticClass:"description"},[e("div",{staticClass:"title"},[t._v("试点地区")]),e("ul",{staticClass:"explain-box"},[e("li",{staticClass:"explain-item"},[t._v("\n            •\n            数字人民币面向试点地区开展试点工作，需根据您所在位置判断是否符合领取条件。\n          ")]),e("li",{staticClass:"explain-item"},[t._v("\n            • 活动时间："+t._s(t.activityInfo.startDate)+"-"+t._s(t.activityInfo.endDate)+"\n          ")]),e("li",{staticClass:"explain-item"},[t._v("\n            • 试点地区包括："),e("strong",[t._v(t._s(t.activityInfo.pilotArea))])])])])]),t.noLocation?e("div",{staticClass:"explain location"},[e("div",[t._v("很抱歉，您所在的地区暂未开启数字⼈⺠币试点⼯作，⽆法领取红包")]),e("div",{staticClass:"btn"},[t._v("请联系赠奖商户")])]):t._e(),!t.noLocation&&t.supportFlag?e("div",{staticClass:"submit"},[e("div",{staticClass:"title"},[t._v("验证手机号")]),e("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号","label-align":"top"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),e("van-field",{attrs:{center:"",label:"验证码",placeholder:"请输入验证码"},scopedSlots:t._u([{key:"button",fn:function(){return[e("van-button",{attrs:{size:"small",type:"primary",disabled:Boolean(t.timer)},on:{click:t.getCode}},[t._v(t._s(t.timer?t.count:"发送验证码"))])]},proxy:!0}],null,!1,4106652352),model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}}),e("van-button",{staticClass:"btn",attrs:{"loading-type":"spinner","loading-text":"领取中...",text:"领取红包",block:"",loading:t.submitLoading,disabled:t.submitLoading},on:{click:t.submitReciveMoney}})],1):t._e(),e("div",{staticClass:"outer"},[e("div",{staticClass:"description"},[e("div",{staticClass:"title"},[t._v("活动概述")]),e("ul",{staticClass:"explain-box"},[t._m(0),e("li",{staticClass:"explain-item"},[e("strong",[t._v("• 活动时间：")]),t._v(" "+t._s(t.activityInfo.startDate)+" -\n            "+t._s(t.activityInfo.endDate)+"\n          ")]),e("li",{staticClass:"explain-item"},[e("strong",[t._v("• 活动地区：")]),t._v(t._s(t.activityInfo.pilotArea)+"\n          ")]),t._m(1),t._m(2)])])]),t._m(3)])])},a=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"explain-item"},[e("strong",[t._v("• 活动对象：")]),t._v("特约白名单用户。\n          ")])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"explain-item"},[e("strong",[t._v("• 红包查看路径：")]),t._v("数字人民币APP-服务-消费红包\n          ")])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"explain-item"},[e("strong",[t._v("• 适用范围：")]),t._v("可在任何支持数字人民币的场景下使用\n          ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"bottom"},[t._v("\n      Copyright © 2023北京华弘集成电路设计有限责任公司\n      "),e("div",[t._v("All rights reserved.")])])}],n=(i("14d9"),i("eb7d")),s=i("2241"),c=i("d399"),l=i("1f0d"),r=i.n(l),d=i("3999"),p=i.n(d),u=i("9d64"),v=i.n(u),g=i("4507"),f=i.n(g),h=i("52bc"),m=i.n(h),y=i("862d"),A=i.n(y),M={name:"index",data(){return{sms:"",phone:"",timer:null,count:"",token:"",loading:!1,activityInfo:{amt:"",activity:"数字人民币红包",endDate:"",startDate:"",activityPeriod:""},supportFlag:!0,noLocation:!1,cityCode:"",bgImg:r.a,homeText:p.a,logo:v.a,amtImg:f.a,redPackImg:m.a,submitLoading:!1}},mounted(){const{token:t}=this.$route.params;this.token=t,this.queryMoneyInfo(),A.a.load({key:"ecb7aed17d1fda77ba3ad8a73a8b99dc",version:"2.0",Loca:{version:"2.0"},plugins:["AMap.Geolocation","AMap.Geocoder"]}).then(t=>{var e=new t.Geolocation({enableHighAccuracy:!0,timeout:1e4});e.getCityInfo((e,i)=>{if("complete"==e){console.log("成功获取位置信息-----\x3e>>",i);const{province:e,city:a,cityCode:n,position:c}=i;if(e&&a)return this.queryActivityCity({province:e,city:a}),void(this.cityCode=n);var o=new t.Geocoder;console.log(c),o.getAddress(c,(t,e)=>{if(console.log(t,e),"complete"===t&&e.regeocode){console.log("成功获取位置信息-----\x3e>>",e.regeocode);const{province:t,city:i,cityCode:o}=e.regeocode.addressComponent;console.log({province:t,city:i}),this.queryActivityCity({province:t,city:i}),this.cityCode=o}else this.noLocation=!0,Object(s["a"])({title:"温馨提示",message:"很抱歉，需要获取您的位置信息，请打开定位权限"})})}else console.log("高德获取定位失败--\x3e>",i),navigator.geolocation.getCurrentPosition(e=>{var i=e.coords.latitude,o=e.coords.longitude,a=new t.Geocoder({city:"010",radius:1e3});a.getAddress([o,i],(t,e)=>{if("complete"===t&&e.regeocode){console.log("成功获取位置信息-----\x3e>>",e.regeocode);const{province:t,city:i,cityCode:o}=e.regeocode.addressComponent;this.queryActivityCity({province:t,city:i}),this.cityCode=o}else this.noLocation=!0,Object(s["a"])({title:"温馨提示",message:"很抱歉，需要获取您的位置信息，请打开定位权限"})})},()=>{this.noLocation=!0,Object(s["a"])({title:"温馨提示",message:"很抱歉，需要获取您的位置信息，请打开定位权限"})})})})},methods:{queryActivityCity(t){return n["a"].postJson("/api/h5/pilotarea/check",t).then(t=>{const{flag:e}=(null===t||void 0===t?void 0:t.body)||{},i="Y"===e;this.supportFlag=i,i||Object(s["a"])({title:"温馨提示",message:"很抱歉，您所在的地区暂未开启数字人民币试点工作，无法领取红包"})})},getCode(){if(!this.isMobile(this.phone))return void Object(c["a"])("手机号有误！");let t=60;this.timer||this.submitMsgCode().then(e=>{const{code:i,msg:o}=e;"200"===i?(this.count=t,this.timer=setInterval(()=>{this.count>0&&this.count<=t?this.count--:(clearInterval(this.timer),this.timer=null)},1e3)):Object(s["a"])({title:"温馨提示",message:o})}).catch(t=>{})},isMobile(t){let e=t.replace(/\s/g,"");return!!e&&(11===e.toString().length&&1==e.toString()[0])},submitMsgCode(){return n["a"].postJson("/api/h5/send/verifycode",{phone:this.phone,token:this.token})},submitReciveMoney(){if(!this.supportFlag)return void Object(s["a"])({title:"温馨提示",message:"很抱歉，您所在的地区暂未开启数字人民币试点工作，无法领取红包"});if(!this.isMobile(this.phone))return void c["a"].fail("手机号有误");if(!this.sms)return void c["a"].fail("请填写短信验证码！");const t=this;this.submitLoading=!0,n["a"].postJson("/api/h5/redpacket/receive",{phone:this.phone,verifyCode:this.sms,token:this.token,custProvinceCode:this.cityCode}).then(e=>{const{tradeState:i,orderNo:o}=e.body;if("00"===i)t.queryReciveState(o);else{if("03"===i||"02"===i)return this.submitLoading=!1,void t.$router.push({path:"/result",query:{sale:this.activityInfo.amt,activity:this.activityInfo.activity}});this.submitLoading=!1,Object(s["a"])({title:"温馨提示",message:e.msg})}})},queryMoneyInfo(){n["a"].getJson("/api/h5/redpacket/info/"+this.token).then(t=>{const{body:e}=t,{activityPeriod:i=""}=e,o=i.split(",");let a="",n="";o.length>1&&(a=this.$dayjs(o[0]).format("YYYY年MM月DD日"),n=this.$dayjs(o[1]).format("YYYY年MM月DD日")),this.activityInfo={...e,startDate:a,endDate:n}})},queryReciveState(t){const e=this;n["a"].getJson("/api/h5/redpacket/status/"+t).then(i=>{const{body:o}=i,{tradeState:a}=o;if("00"===a)setTimeout(()=>{e.queryReciveState(t)},1e3);else{if("03"===a||"02"===a)return e.submitLoading=!1,void e.$router.push({path:"/result",query:{sale:e.activityInfo.amt,activity:e.activityInfo.activity}});e.submitLoading=!1,Object(s["a"])({title:"温馨提示",message:i.msg})}})}}},b=M,I=(i("07bb"),i("2877")),_=Object(I["a"])(b,o,a,!1,null,"50d0b133",null);e["default"]=_.exports},"7cfe":function(t,e,i){},"862d":function(t,e,i){"use strict";(function(e,i){t.exports=i()})(0,(function(){function t(t){var o=[];return t.AMapUI&&o.push(e(t.AMapUI)),t.Loca&&o.push(i(t.Loca)),Promise.all(o)}function e(t){return new Promise((function(e,i){var c=[];if(t.plugins)for(var l=0;l<t.plugins.length;l+=1)-1==a.AMapUI.plugins.indexOf(t.plugins[l])&&c.push(t.plugins[l]);if(n.AMapUI===o.failed)i("前次请求 AMapUI 失败");else if(n.AMapUI===o.notload){n.AMapUI=o.loading,a.AMapUI.version=t.version||a.AMapUI.version,l=a.AMapUI.version;var r=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+l+"/main.js",d.onerror=function(t){n.AMapUI=o.failed,i("请求 AMapUI 失败")},d.onload=function(){if(n.AMapUI=o.loaded,c.length)window.AMapUI.loadUI(c,(function(){for(var t=0,i=c.length;t<i;t++){var o=c[t].split("/").slice(-1)[0];window.AMapUI[o]=arguments[t]}for(e();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(e();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},r.appendChild(d)}else n.AMapUI===o.loaded?t.version&&t.version!==a.AMapUI.version?i("不允许多个版本 AMapUI 混用"):c.length?window.AMapUI.loadUI(c,(function(){for(var t=0,i=c.length;t<i;t++){var o=c[t].split("/").slice(-1)[0];window.AMapUI[o]=arguments[t]}e()})):e():t.version&&t.version!==a.AMapUI.version?i("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(t){t?i(t):c.length?window.AMapUI.loadUI(c,(function(){for(var t=0,i=c.length;t<i;t++){var o=c[t].split("/").slice(-1)[0];window.AMapUI[o]=arguments[t]}e()})):e()}))}))}function i(t){return new Promise((function(e,i){if(n.Loca===o.failed)i("前次请求 Loca 失败");else if(n.Loca===o.notload){n.Loca=o.loading,a.Loca.version=t.version||a.Loca.version;var c=a.Loca.version,l=a.AMap.version.startsWith("2"),r=c.startsWith("2");if(l&&!r||!l&&r)i("JSAPI 与 Loca 版本不对应！！");else{l=a.key,r=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+c+"&key="+l,d.onerror=function(t){n.Loca=o.failed,i("请求 AMapUI 失败")},d.onload=function(){for(n.Loca=o.loaded,e();s.Loca.length;)s.Loca.splice(0,1)[0]()},r.appendChild(d)}}else n.Loca===o.loaded?t.version&&t.version!==a.Loca.version?i("不允许多个版本 Loca 混用"):e():t.version&&t.version!==a.Loca.version?i("不允许多个版本 Loca 混用"):s.Loca.push((function(t){t?i(t):i()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o;(function(t){t.notload="notload",t.loading="loading",t.loaded="loaded",t.failed="failed"})(o||(o={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},s={AMap:[],AMapUI:[],Loca:[]},c=[],l=function(t){"function"==typeof t&&(n.AMap===o.loaded?t(window.AMap):c.push(t))};return{load:function(e){return new Promise((function(i,s){if(n.AMap==o.failed)s("");else if(n.AMap==o.notload){var r=e.key,d=e.version,p=e.plugins;r?(window.AMap&&"lbs.amap.com"!==location.host&&s("禁止多种API加载方式混用"),a.key=r,a.AMap.version=d||a.AMap.version,a.AMap.plugins=p||a.AMap.plugins,n.AMap=o.loading,d=document.body||document.head,window.___onAPILoaded=function(a){if(delete window.___onAPILoaded,a)n.AMap=o.failed,s(a);else for(n.AMap=o.loaded,t(e).then((function(){i(window.AMap)}))["catch"](s);c.length;)c.splice(0,1)[0]()},p=document.createElement("script"),p.type="text/javascript",p.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+r+"&plugin="+a.AMap.plugins.join(","),p.onerror=function(t){n.AMap=o.failed,s(t)},d.appendChild(p)):s("请填写key")}else if(n.AMap==o.loaded)if(e.key&&e.key!==a.key)s("多个不一致的 key");else if(e.version&&e.version!==a.AMap.version)s("不允许多个版本 JSAPI 混用");else{if(r=[],e.plugins)for(d=0;d<e.plugins.length;d+=1)-1==a.AMap.plugins.indexOf(e.plugins[d])&&r.push(e.plugins[d]);r.length?window.AMap.plugin(r,(function(){t(e).then((function(){i(window.AMap)}))["catch"](s)})):t(e).then((function(){i(window.AMap)}))["catch"](s)}else if(e.key&&e.key!==a.key)s("多个不一致的 key");else if(e.version&&e.version!==a.AMap.version)s("不允许多个版本 JSAPI 混用");else{var u=[];if(e.plugins)for(d=0;d<e.plugins.length;d+=1)-1==a.AMap.plugins.indexOf(e.plugins[d])&&u.push(e.plugins[d]);l((function(){u.length?window.AMap.plugin(u,(function(){t(e).then((function(){i(window.AMap)}))["catch"](s)})):t(e).then((function(){i(window.AMap)}))["catch"](s)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}))},"9d64":function(t,e,i){t.exports=i.p+"img/logo.9a381d24.png"}}]);
//# sourceMappingURL=chunk-2369359a.72aa5d2a.js.map