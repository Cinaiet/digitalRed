(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2528d12f"],{3851:function(t,i,s){},"7abe":function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t._self._c;return i("div",{staticClass:"home-box display-flex box-column"},[t.loading?i("div",{staticClass:"loading"},[i("van-loading",{attrs:{type:"spinner",color:"#ccc"}})],1):i("div",{staticClass:"box-flex1 content"},[i("div",{staticClass:"vouchers"},[i("div",{staticClass:"vouchers-left"},[i("div",[t._v("待领取")]),i("div",{staticClass:"sale"},[i("span",[t._v("￥")]),t._v(t._s(t.activityInfo.amt))])]),i("div",{staticClass:"vouchers-right"},[i("div",[t._v(t._s(t.activityInfo.activity))]),i("div",[t._v("*领取无需中行银行卡")])])]),t.supportFlag?t._e():i("div",{staticClass:"explain location permission"},[i("div",[t._v("很抱歉，您所在的地区暂未开启数字人民币试点工作，无法领取红包")]),i("div",{staticClass:"btn"},[t._v("请联系赠奖商户")])]),t.supportFlag?t._e():i("div",{staticClass:"outer"},[i("div",{staticClass:"description"},[i("div",{staticClass:"title"},[t._v("试点地区")]),i("ul",{staticClass:"explain-box"},[i("li",{staticClass:"explain-item"},[t._v("\n            •\n            数字人民币面向试点地区开展试点工作，需根据您所在位置判断是否符合领取条件。\n          ")]),i("li",{staticClass:"explain-item"},[t._v("\n            • 活动时间："+t._s(t.activityInfo.startDate)+"-"+t._s(t.activityInfo.endDate)+"\n          ")]),i("li",{staticClass:"explain-item"},[t._v("\n            • 试点地区包括："),i("strong",[t._v(t._s(t.activityInfo.pilotArea))])])])])]),t.noLocation?i("div",{staticClass:"explain location"},[i("div",[t._v("很抱歉，需要获取您的定位信息")]),i("div",{staticClass:"btn"},[t._v("开放定位权限")])]):t._e(),!t.noLocation&&t.supportFlag?i("div",{staticClass:"submit"},[i("div",{staticClass:"title"},[t._v("验证手机号")]),i("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号","label-align":"top"},model:{value:t.phone,callback:function(i){t.phone=i},expression:"phone"}}),i("van-field",{attrs:{center:"",clearable:"",label:"短信验证码",placeholder:"请输入短信验证码"},scopedSlots:t._u([{key:"button",fn:function(){return[i("van-button",{attrs:{size:"small",type:"primary",disabled:Boolean(t.timer)},on:{click:t.getCode}},[t._v(t._s(t.timer?t.count:"发送验证码"))])]},proxy:!0}],null,!1,4106652352),model:{value:t.sms,callback:function(i){t.sms=i},expression:"sms"}}),i("div",{staticClass:"btn",on:{click:t.submitReciveMoney}},[t._v("领取红包")])],1):t._e(),i("div",{staticClass:"outer"},[i("div",{staticClass:"description"},[i("div",{staticClass:"title"},[t._v("活动概述")]),i("ul",{staticClass:"explain-box"},[t._m(0),i("li",{staticClass:"explain-item"},[i("strong",[t._v("• 活动时间：")]),t._v(" "+t._s(t.activityInfo.startDate)+" -\n            "+t._s(t.activityInfo.endDate)+"\n          ")]),i("li",{staticClass:"explain-item"},[i("strong",[t._v("• 活动地区：")]),t._v(t._s(t.activityInfo.pilotArea)+"\n          ")]),t._m(1),t._m(2)])])])]),t._m(3)])},a=[function(){var t=this,i=t._self._c;return i("li",{staticClass:"explain-item"},[i("strong",[t._v("• 活动对象：")]),t._v("特约白名单用户。\n          ")])},function(){var t=this,i=t._self._c;return i("li",{staticClass:"explain-item"},[i("strong",[t._v("• 红包查看路径：")]),t._v("数字人民币APP-服务-消费红包\n          ")])},function(){var t=this,i=t._self._c;return i("li",{staticClass:"explain-item"},[i("strong",[t._v("• 适用范围：")]),t._v("可在任何支持数字人民币的场景下使用\n          ")])},function(){var t=this,i=t._self._c;return i("div",{staticClass:"bottom"},[t._v("\n    Copyright © 2023北京华弘集成电路设计有限责任公司\n    "),i("div",[t._v("All rights reserved.")])])}],n=(s("14d9"),s("eb7d")),o=s("2241"),l=s("d399"),c={name:"index",data(){return{sms:"",phone:"",timer:null,count:"",token:"",loading:!1,activityInfo:{amt:"",activity:"数字人民币红包",endDate:"",startDate:"",activityPeriod:""},supportFlag:!0,noLocation:!1,cityCode:""}},mounted(){const{token:t}=this.$route.params;this.token=t,this.queryMoneyInfo(),window.AMap&&AMap.plugin("AMap.Geolocation",()=>{var t=new AMap.Geolocation({enableHighAccuracy:!1,timeout:1e4});t.getCityInfo((t,i)=>{if("complete"==t){const{province:t,city:s,cityCode:e}=i;this.queryActivityCity({province:t,city:s}),this.cityCode=e}else this.noLocation=!0})})},methods:{queryActivityCity(t){return n["a"].postJson("/api/h5/pilotarea/check",t).then(t=>{console.log("rr",t);const{flag:i}=(null===t||void 0===t?void 0:t.body)||{},s="Y"===i;this.supportFlag=s,s||Object(o["a"])({title:"温馨提示",message:"很抱歉，您所在的地区暂未开启数字人民币试点工作，无法领取红包"})})},getCode(){if(!this.isMobile(this.phone))return void Object(l["a"])("手机号有误！");let t=60;this.timer||this.submitMsgCode().then(i=>{const{code:s}=i;"200"===s&&(this.count=t,this.timer=setInterval(()=>{this.count>0&&this.count<=t?this.count--:(clearInterval(this.timer),this.timer=null)},1e3))})},isMobile(t){let i=t.replace(/\s/g,"");return!!i&&(11===i.toString().length&&1==i.toString()[0])},openApp(){try{window.location.href="dcep://uniwallet/startApp"}catch(t){window.location.href="https://pilot.app.ecny.pbcdci.cn/download/index.html"}finally{window.location.href="https://pilot.app.ecny.pbcdci.cn/download/index.html"}},submitMsgCode(){n["a"].postJson("/api/h5/send/verifycode",{phone:this.phone,token:this.token})},submitReciveMoney(){this.supportFlag?this.isMobile(this.phone)?this.sms?n["a"].postJson("/api/h5/redpacket/receive",{phone:this.phone,verifyCode:this.sms,token:this.token,custProvinceCode:this.cityCode}).then(t=>{const{tradeState:i}=t.body;if("03"!==i)Object(o["a"])({title:"温馨提示",message:t.msg});else{const t=this;t.$router.push({path:"/result",query:{sale:this.activityInfo.amt,activity:this.activityInfo.activity}})}}):l["a"].fail("请填写短信验证码！"):l["a"].fail("手机号有误"):Object(o["a"])({title:"温馨提示",message:"很抱歉，您所在的地区暂未开启数字人民币试点工作，无法领取红包"})},queryMoneyInfo(){n["a"].getJson("/api/h5/redpacket/info/"+this.token).then(t=>{const{body:i}=t,{activityPeriod:s=""}=i,e=s.split(",");let a="",n="";e.length>1&&(a=this.$dayjs(e[0]).format("YYYY年MM月DD日"),n=this.$dayjs(e[1]).format("YYYY年MM月DD日")),this.activityInfo={...i,startDate:a,endDate:n}})}}},r=c,v=(s("9a9c"),s("2877")),d=Object(v["a"])(r,e,a,!1,null,"fff6773c",null);i["default"]=d.exports},"9a9c":function(t,i,s){"use strict";s("3851")}}]);
//# sourceMappingURL=chunk-2528d12f.b9d6b64f.js.map